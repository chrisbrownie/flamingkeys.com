---
layout: post
title: IIS 7 Backup and Restore
date: 2010-12-21 10:05:26.000000000 +11:00
type: post
published: true
status: publish
categories:
- Technology
tags:
- Backup
- Exchange
- IIS
- Server 2008 R2
- tips
- windows
meta:
  _edit_last: '1'
  _sexybookmarks_shortUrl: http://bit.ly/fO35Cx
  _sexybookmarks_permaHash: 187d6320b29219150fca46318689056b
  dsq_thread_id: '205526823'
  _jd_tweet_this: ''
  _jd_twitter: ''
  _wp_jd_clig: ''
  _wp_jd_bitly: ''
  _wp_jd_wp: ''
  _wp_jd_yourls: ''
  _wp_jd_url: ''
  _wp_jd_target: ''
  _jd_wp_twitter: ''
  _jd_post_meta_fixed: 'true'
author:
  login: chris
  email: chris@flamingkeys.com
  display_name: Chris
  first_name: Chris
  last_name: Brown
---
<p>With Exchange becoming only more integrated with Microsoft’s web server, <a href="http://en.wikipedia.org/wiki/Internet_Information_Services" target="_blank">Internet Information Services</a>, it is becoming a more and more critical service. One thing I’ve always wanted, but have never been satisfied with, is the backup and restore capabilities (or lack thereof) built into IIS. Apache is a very simple web server to back up, as everything is flat file. On the other hand, IIS uses a combination of the registry and file configuration. This is just a graphical approach to the “appcmd” functionality of IIS.</p>
<p>For this reason, I was quite excited when I found <a href="http://blogs.msdn.com/b/rakkimk/archive/2007/11/04/iis7-backup-restore-ui-module.aspx" target="_blank">this blog post</a> by <a href="http://blogs.msdn.com/b/rakkimk" target="_blank">Rakki Muthukumar</a> over at MSDN blogs. Rakki has written a module for IIS 7 (which also works with 7.5) to allow for simple backing up and restoring of IIS. Simply download the extension <a href="http://www.iis.net/community/default.aspx?tabid=34&amp;g=6&amp;i=1552" target="_blank">here</a> to get started.</p>
<p>Installation is not trivial but should not pose any problem to those familiar with the keyboard and mouse. From a command line run <span style="font-family: Courier New;"><strong>gacutil –i IIS7BackupRestore.dll</strong></span> to insert it into your <a href="http://msdn.microsoft.com/en-us/library/yf1d93sz.aspx" target="_blank">Global Assembly Cache</a>. Secondly, open <span style="font-family: Courier New;"><strong>%WINDIR%\System32\InetSrv\config\Administration.config</strong></span> in your favourite text editor, then inside the <span style="font-family: Courier New;"><strong>&lt;moduleProviders&gt;</strong></span> section, add the following line:</p>
<p><span style="font-family: Courier New;"><strong>&lt;add name="IIS7BackupRestoreUI" type="IIS7BackupRestoreUI.MyModuleProvider, IIS7BackupRestoreUI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=db9daa3d2ea5f6fd" /&gt;</strong></span></p>
<p><span style="font-family: Courier New;"><span style="font-family: Arial;">Inside the</span><strong> &lt;modules&gt;</strong> </span><span style="font-family: Arial;">section of the same file, add the following line:</span></p>
<p><span style="font-family: Courier New;"><strong>&lt;add name="IIS7BackupRestoreUI" /&gt;</strong></span></p>
<p>Restart IIS Manager and you’ll see the module here:</p>
<p style="text-align: center;"><a href="https://www.flamingkeys.com/wp-content/uploads/2010/12/image.png"><img class="aligncenter" style="background-image: none; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border: 0px;" title="image" src="{{ site.baseurl }}/assets/image_thumb.png" border="0" alt="image" width="244" height="115" /></a></p>
<p>One thing to note is that the module (at least graphically) does not give you the option to delete or rename the backups, so take a moment to decide on a naming convention. I’d suggest something like <em>Date – Action</em>. For example <em>2011-12-21-NewSSLCertificate</em>.</p>
