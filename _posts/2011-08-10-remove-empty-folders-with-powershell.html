---
layout: post
title: Remove Empty Folders with PowerShell
date: 2011-08-10 11:52:36.000000000 +10:00
type: post
published: true
status: publish
categories:
- Technology
tags:
- File Services
- FSRM
- PowerShell
- Scripting
- tips
meta:
  _jd_tweet_this: 'yes'
  _jd_twitter: ''
  _wp_jd_clig: ''
  _wp_jd_bitly: ''
  _wp_jd_wp: ''
  _wp_jd_yourls: ''
  _wp_jd_url: ''
  _wp_jd_target: ''
  _jd_wp_twitter: ''
  _jd_post_meta_fixed: 'true'
  _syntaxhighlighter_encoded: '1'
  _edit_last: '1'
  robotsmeta: index,follow
  dsq_thread_id: '381814742'
author:
  login: chris
  email: chris@flamingkeys.com
  display_name: Chris
  first_name: Chris
  last_name: Brown
---
<p>Here’s a quick one for removing all empty folders within a specified folder structure. Theoeretically (untested) it could work with other situations that address PSDrives (try <em>Get-PSDrive</em>).</p>
<p>My organisation uses <a href="http://technet.microsoft.com/en-us/library/cc755603(WS.10).aspx" target="_blank">FSRM</a> to age data on our “scratch” network shares. Files are automatically removed after 30 days. This introduced a small problem with leaving empty folders behind, causing some confusion. The result is a network share with no old files, but with lots of empty folders. This script will delete all folders with no children. (Note: in our production environment, I have preceded this with a script that deletes all unnecessary/folder state files such as <em><a href="http://en.wikipedia.org/wiki/Windows_thumbnail_cache">thumbs.db</a></em> and <em><a href="http://en.wikipedia.org/wiki/.DS_Store">.ds_store</a></em>. These files are hidden on their native OSes and while a directory may appear empty, if it contains these files the script below will not handle it (I realise I could have included an exclusion list of files to ignore when deleting directories, but that’s really beyond the scope of what I wanted this script to do).</p>
<p>[ps]<br />
#############################################################################<br />
# Script: Remove-EmptyChildFolders.ps1<br />
# Author: Chris Brown    http://www.flamingkeys.com/<br />
# Date: 10/08/2011<br />
# Keywords: Folders, Empty, Directories, Containers<br />
# Comments:<br />
#<br />
# +------------+-----+---------------------------------------------------------+<br />
# |       Date | Usr | Description                                             |<br />
# +------------+-----+---------------------------------------------------------+<br />
# | 10/08/2011 | CJB | Initial Script                                          |<br />
# +------------+-----+---------------------------------------------------------+<br />
#<br />
# DISCLAIMER<br />
# ==========<br />
# THIS CODE IS MADE AVAILABLE AS IS, WITHOUT WARRANTY OF ANY KIND. THE ENTIRE<br />
# RISK OF THE USE OR THE RESULTS FROM THE USE OF THIS CODE REMAINS WITH THE USER.<br />
#############################################################################</p>
<p># What's the top level directory we're going to look under?<br />
$rootPath = &quot;C:\Scripts\Scratch\&quot;</p>
<p># Get each item under the current directory recursively<br />
foreach($childItem in (Get-ChildItem $rootPath -Recurse))<br />
{<br />
	# if it's a folder AND does not have child items of its own<br />
	if( ($childItem.PSIsContainer) -and (!(Get-ChildItem -Recurse -Path $childItem.FullName)))<br />
	{<br />
		# Delete it<br />
		Remove-Item $childItem.FullName -Confirm:$false<br />
	}<br />
}[/ps]</p>
