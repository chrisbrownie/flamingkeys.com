---
layout: post
title: Exchange 2010 Mailboxes over Size Limit Report
date: 2011-04-04 11:47:21.000000000 +10:00
type: post
published: true
status: publish
categories:
- Technology
tags:
- Exchange
- PowerShell
- Reporting
- tips
meta:
  _jd_tweet_this: ''
  _jd_twitter: ''
  _wp_jd_clig: ''
  _wp_jd_bitly: http://fla.im/hT70Oq
  _wp_jd_wp: ''
  _wp_jd_yourls: ''
  _wp_jd_url: ''
  _wp_jd_target: http://www.flamingkeys.com/2011/04/exchange-2010-mailboxes-over-size-limit-report/?utm_campaign=twitter&utm_medium=twitter&utm_source=twitter
  _jd_wp_twitter: ''
  _jd_post_meta_fixed: 'true'
  _edit_last: '1'
  robotsmeta: index,follow
  dsq_thread_id: '270342931'
  _syntaxhighlighter_encoded: '1'
author:
  login: chris
  email: chris@flamingkeys.com
  display_name: Chris
  first_name: Chris
  last_name: Brown
---
<p>Here's a fairly rudimentary report I threw together this morning that will notify my HelpDesk staff of Exchange 2010 Mailbox users over their mailbox size limit. I didn't feel that formatting or any fancy xml/xsl was necessary for this particular job. The <a href="http://en.wiktionary.org/wiki/KISS">KISS</a> principle is strongly in play here. Here it is:<br />
<strong></strong></p>
<p>[ps]# -------------------------------------------------------------------------------<br />
# Script: Get-MailboxesOverSizeLimit.ps1<br />
# Author: Chris Brown<br />
# Date: 04/04/2011 10:41:00<br />
# Keywords:<br />
# comments:<br />
#<br />
# Versioning<br />
# 04/04/2011  CJB  Initial Script<br />
#<br />
# -------------------------------------------------------------------------------</p>
<p># -------------------------------------------------------------------------------<br />
#                           ~ ~ ~ Variables ~ ~ ~<br />
# ~~ Mail Server Details ~~<br />
$SmtpServer = &quot;mailserver.yourdomain.local&quot;<br />
$FromAddress = &quot;alerts@yourdomain.com&quot;<br />
$ToAddress = &quot;HelpDesk@yourdomain.com&quot;<br />
$Subject = &quot;[Exchange] Mailboxes over size limits&quot;<br />
#<br />
#<br />
#-------------------------------------------------------------------------------<br />
# Import the Exchange 2010 snap-in</p>
<p>if ( (Get-PSSnapin -Name Microsoft.Exchange.Management.PowerShell.E2010 -ErrorAction SilentlyContinue) -eq $null) {<br />
 Write-Verbose &quot;Exchange 2010 snapin is not loaded. Loading it now.&quot;<br />
 try { Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010; Write-Verbose &quot;Loaded Exchange 2010 snapin&quot; }<br />
 catch { Write-Error &quot;Could not load Exchange 2010 snapins!&quot;; }<br />
}</p>
<p>$overLimit = Get-Mailbox | Get-MailboxStatistics -WarningAction SilentlyContinue | Where {&quot;ProhibitSend&quot;,&quot;MailboxDisabled&quot; -contains $_.StorageLimitStatus}</p>
<p>if ($overLimit.Count -gt 0) {<br />
 $mailBody = $overLimit | ft DisplayName,TotalItemSize,StorageLimitStatus | Out-String<br />
 Send-MailMessage -Body $mailBody.ToString() -From $FromAddress -SmtpServer $SmtpServer -Subject $Subject -To $toAddress<br />
} else {<br />
 &quot;No results&quot;<br />
}[/ps]</p>
