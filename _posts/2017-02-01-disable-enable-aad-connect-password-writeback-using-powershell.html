---
layout: post
title: How to Disable and Enable AAD Connect Password Writeback using PowerShell
date: 2017-02-01 10:00:03.000000000 +11:00
type: post
published: true
status: publish
categories:
- Technology
tags:
- AAD Connect
- AADSync
- Active Directory
- Azure AD
- Computers
- DirSync
- Microsoft
- Office 365
- Passwords
- PowerShell
- Scripting
- Security
meta:
  _yoast_wpseo_primary_category: '8'
  _yoast_wpseo_content_score: '30'
  _syntaxhighlighter_encoded: '1'
  _edit_last: '1'
  amazonS3_cache: a:2:{s:92:"//static.flamingkeys.com/wp-content/uploads/2017/02/01223644/aadconnect-upgrade-blocker1.png";i:1285;s:76:"//flamingkeys.com/wp-content/uploads/2017/02/aadconnect-upgrade-blocker1.png";i:1285;}
  _yoast_wpseo_focuskw_text_input: Password Writeback
  _yoast_wpseo_focuskw: Password Writeback
  _yoast_wpseo_linkdex: '39'
  dsq_thread_id: '5512264420'
author:
  login: chris
  email: chris@flamingkeys.com
  display_name: Chris
  first_name: Chris
  last_name: Brown
---
<p>Disabling AAD Connect Password Writeback is easy in both the GUI and Windows PowerShell. In a recent case I found myself troubleshooting AAD Connect where it was in a very broken state that meant the GUI was unavailable due to a pending upgrade:</p>
<p><img src="{{ site.baseurl }}/assets/aadconnect-upgrade-blocker1.png" alt="" width="880" height="620" class="aligncenter size-full wp-image-1285" /></p>
<p>As part of my troubleshooting, I determined that Password Writeback needed to be disabled. Unfortunately, the dialogue shown above is blocking, which means I was unable to switch it off using the regular GUI. In comes PowerShell:</p>
<h2>Disable Password Sync</h2>
<p>To disable AAD Connect Password Writeback using Windows PowerShell, run the following commands from a shell as administrator on your AAD Connect server:</p>
<p>https://gist.github.com/chrisbrownie/c686925d97d5607d47e7381ef54da9f6</p>
<h2>Enable Password Sync</h2>
<p>To enable AAD Connect Password Writeback using Windows Powershell, run the following commands from a shell as administrator on your AAD Connect server:</p>
<p>https://gist.github.com/chrisbrownie/440cf9cb0b2d2409335836fee23188d4</p>
